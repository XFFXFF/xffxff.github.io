<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/github.min.css"/><title>我眼中的 k8s</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/7eb40cdb0d262f08.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7eb40cdb0d262f08.css" data-n-g=""/><link rel="preload" href="/_next/static/css/69a316e8a13b4830.css" as="style"/><link rel="stylesheet" href="/_next/static/css/69a316e8a13b4830.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-e70c6273bfe3f237.js" defer=""></script><script src="/_next/static/chunks/main-d719a31ca00eb19c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fcb060ba8fa2b368.js" defer=""></script><script src="/_next/static/chunks/640-1a3a0dc0790efd2e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-03d1a37039c741de.js" defer=""></script><script src="/_next/static/n4eJO9tW-2yshcvrVZP5m/_buildManifest.js" defer=""></script><script src="/_next/static/n4eJO9tW-2yshcvrVZP5m/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="layout_container__fbLkO"><main><article><h1 class="utils_headingXl__u25Y2">我眼中的 k8s</h1><div class="utils_lightText__eUzGY"><time dateTime="2023-01-05">January 5, 2023</time></div><div><p>今年已经是工作的第三年了，从一开始工作就接触并使用 k8s，但使用方式主要是起一个 pod 作为开发机。对 k8s 的第一映像是很复杂，我通常使用 rancher 界面来操作，rancher 界面就很复杂，什么 service，workload，development 等等让我摸不着头脑。由于我的需求很简单，导致我也没有任何动力去深入了解 k8s。</p>
<p>转变发生在两个月前，我以后端开发的身份投入到一个微服务架构的项目，k8s 对这个项目非常重要。但在这两个月里，我对 k8s 的理解仍然非常有限，将我们的服务部署到 k8s 并不是我的主要工作，同事写好了复杂的配置，我只需要 <code>helm install</code> 和 <code>helm upgrade</code> 。。。</p>
<p>直到上周末，我开始阅读 《kubernetes in action》，发现 k8s 并没有想象的那么复杂，且被它的设计，它的抽象所吸引。现在我对 k8s 有了一些更 high level 的认识，回过头来看 k8s 在我所参与的项目中起到的作用，记录我眼中的 k8s。</p>
<blockquote>
<p>我最开始读的 《kubernetes in action》是第一版，但读了几章后发现有点旧，书中的代码/命令跑不通了，就去看了第二版，第二版目前还是预览版，我是在 <a href="https://livebook.manning.com/book/kubernetes-in-action-second-edition">https://livebook.manning.com/book/kubernetes-in-action-second-edition</a> 看的，付费支持了作者，现在看来真是物超所值。</p>
</blockquote>
<p>一开始就使用 k8s，享受着它带来的便利，会对这些便利习以为常，甚至觉得都是基本操作，就像现在出生的小朋友，从小接触智能手机，互联网，当然不会觉得这些东西很厉害。所以应该读读历史，没有 k8s 的时代后端开发是什么样子？尤其对我这种半路出家的后端开发来说，更应该读读历史。</p>
<h2>谁去部署服务</h2>
<p>除了 k8s 本身是公司运维团队帮忙搭建的，之后所有的服务都是由有我们 dev 团队自己部署的。我们同时负责业务逻辑的开发与产品的部署，这有什么好处？第一，部署并不是和业务逻辑完全分离的，在部署的时候可能遇到很多问题，这些问题可能和业务逻辑非常相关，如果对业务逻辑熟悉，当然能更快定位并解决问题。第二，我们的业务逻辑经常变化，除了功能上的变化，还会有很多 bug，我们需要经常重新部署或者更新部署，如果每次部署都要去麻烦运维团队，那么我们的效率就会大打折扣。</p>
<p>k8s 让 dev 团队自己部署服务成为了可能，你不需要去关心底层的硬件，操作系统内核的版本，不同的服务应该部署在哪台机器，不同的机器如何通信。。。</p>
<h2>如何部署到共有云</h2>
<p>我们在开发测试过程中将服务部署在公司内部的 k8s 集群上，但是在正式上线之前，我们需要将服务部署到共有云上，比如阿里云，腾讯云，华为云等等。我们需要另一套东西吗？部署到共有云需要很大的人力成本吗？No！现在基本上所有的公有云都会集成 k8s，这样我们就可以将部署在公司内部的服务无缝迁移到公有云，对于 k8s 来说，它接受的 API 都是一样的，它提供的服务也都是一样的。很难想象没有 k8s，或 k8s 没有成为部署的标准之前，每家云厂商有自己的 API，有自己的部署方式，这样的话，需要更多的学习成本，更换云厂商的成本也会变高。</p>
<h2>为微服务而生</h2>
<p>我们的项目就是微服务架构，现在有大约十几个服务，如果没有 k8s，手动部署的话，真是很头疼。它们应该部署到哪些机器？这些服务之间如何互相发现？怎么把服务暴露出来让所有人能访问到？有个服务挂了怎么办？怎么给服务做 scaling？如何做 load balance？有了 k8s 后，这些问题都可以轻松解决，有些甚至你完全不用操心，k8s 自动就帮你做了，比如某个服务挂了就会自动帮你重启，你甚至不需要任何配置。</p>
<hr>
<p>今天主要聊聊我个人使用 k8s 的感受，接下来我会写一些文章，或者叫笔记更合适，去记录我在读 《Kubernetes in Action, 2nd Edition》这本书的过程</p></div></article></main><div class="layout_backToHome__9sjx_"><a href="/">← Back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"15_kubernetes","contentHtml":"\u003cp\u003e今年已经是工作的第三年了，从一开始工作就接触并使用 k8s，但使用方式主要是起一个 pod 作为开发机。对 k8s 的第一映像是很复杂，我通常使用 rancher 界面来操作，rancher 界面就很复杂，什么 service，workload，development 等等让我摸不着头脑。由于我的需求很简单，导致我也没有任何动力去深入了解 k8s。\u003c/p\u003e\n\u003cp\u003e转变发生在两个月前，我以后端开发的身份投入到一个微服务架构的项目，k8s 对这个项目非常重要。但在这两个月里，我对 k8s 的理解仍然非常有限，将我们的服务部署到 k8s 并不是我的主要工作，同事写好了复杂的配置，我只需要 \u003ccode\u003ehelm install\u003c/code\u003e 和 \u003ccode\u003ehelm upgrade\u003c/code\u003e 。。。\u003c/p\u003e\n\u003cp\u003e直到上周末，我开始阅读 《kubernetes in action》，发现 k8s 并没有想象的那么复杂，且被它的设计，它的抽象所吸引。现在我对 k8s 有了一些更 high level 的认识，回过头来看 k8s 在我所参与的项目中起到的作用，记录我眼中的 k8s。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我最开始读的 《kubernetes in action》是第一版，但读了几章后发现有点旧，书中的代码/命令跑不通了，就去看了第二版，第二版目前还是预览版，我是在 \u003ca href=\"https://livebook.manning.com/book/kubernetes-in-action-second-edition\"\u003ehttps://livebook.manning.com/book/kubernetes-in-action-second-edition\u003c/a\u003e 看的，付费支持了作者，现在看来真是物超所值。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e一开始就使用 k8s，享受着它带来的便利，会对这些便利习以为常，甚至觉得都是基本操作，就像现在出生的小朋友，从小接触智能手机，互联网，当然不会觉得这些东西很厉害。所以应该读读历史，没有 k8s 的时代后端开发是什么样子？尤其对我这种半路出家的后端开发来说，更应该读读历史。\u003c/p\u003e\n\u003ch2\u003e谁去部署服务\u003c/h2\u003e\n\u003cp\u003e除了 k8s 本身是公司运维团队帮忙搭建的，之后所有的服务都是由有我们 dev 团队自己部署的。我们同时负责业务逻辑的开发与产品的部署，这有什么好处？第一，部署并不是和业务逻辑完全分离的，在部署的时候可能遇到很多问题，这些问题可能和业务逻辑非常相关，如果对业务逻辑熟悉，当然能更快定位并解决问题。第二，我们的业务逻辑经常变化，除了功能上的变化，还会有很多 bug，我们需要经常重新部署或者更新部署，如果每次部署都要去麻烦运维团队，那么我们的效率就会大打折扣。\u003c/p\u003e\n\u003cp\u003ek8s 让 dev 团队自己部署服务成为了可能，你不需要去关心底层的硬件，操作系统内核的版本，不同的服务应该部署在哪台机器，不同的机器如何通信。。。\u003c/p\u003e\n\u003ch2\u003e如何部署到共有云\u003c/h2\u003e\n\u003cp\u003e我们在开发测试过程中将服务部署在公司内部的 k8s 集群上，但是在正式上线之前，我们需要将服务部署到共有云上，比如阿里云，腾讯云，华为云等等。我们需要另一套东西吗？部署到共有云需要很大的人力成本吗？No！现在基本上所有的公有云都会集成 k8s，这样我们就可以将部署在公司内部的服务无缝迁移到公有云，对于 k8s 来说，它接受的 API 都是一样的，它提供的服务也都是一样的。很难想象没有 k8s，或 k8s 没有成为部署的标准之前，每家云厂商有自己的 API，有自己的部署方式，这样的话，需要更多的学习成本，更换云厂商的成本也会变高。\u003c/p\u003e\n\u003ch2\u003e为微服务而生\u003c/h2\u003e\n\u003cp\u003e我们的项目就是微服务架构，现在有大约十几个服务，如果没有 k8s，手动部署的话，真是很头疼。它们应该部署到哪些机器？这些服务之间如何互相发现？怎么把服务暴露出来让所有人能访问到？有个服务挂了怎么办？怎么给服务做 scaling？如何做 load balance？有了 k8s 后，这些问题都可以轻松解决，有些甚至你完全不用操心，k8s 自动就帮你做了，比如某个服务挂了就会自动帮你重启，你甚至不需要任何配置。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e今天主要聊聊我个人使用 k8s 的感受，接下来我会写一些文章，或者叫笔记更合适，去记录我在读 《Kubernetes in Action, 2nd Edition》这本书的过程\u003c/p\u003e","title":"我眼中的 k8s","date":"2023-01-05"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"15_kubernetes"},"buildId":"n4eJO9tW-2yshcvrVZP5m","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>